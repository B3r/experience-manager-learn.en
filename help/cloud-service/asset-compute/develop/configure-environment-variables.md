
## Configure the environment variables

Before beginning development of the Asset Compute workers, first ensure the project is configured with the account information provided by Adobe I/O and your Cloud Storage provider in order for the application to deploy to and execute within the Adobe I/O Runtime environment.

Once a project has been created, it must be configured with Adobe I/O and cloud storage credentials. These values are set in the generated `.env` file in the root of the project as key/value pairs.

Note that other custom parameters and secrets can be stored in the `.env` file as well, such as credentials to 3rd party web services the Asset Compute application connects to.

![\.env file](assets/asset-compute-project/env-file.png)

## Reference the `private.key`

Open the `.env` file, uncomment the following key, and provide the absolute path on your filesystem the `private.key` that pairs with the public certificate added to your Adobe I/O FireFly project.

If your key pair was generated by Adobe I/O, it was auto-downloaded as part of the  `config.zip`.
If you provided the public key to Adobe I/O, then you should also be in possesion of the matching private key.
If you do not have these key pairs, you can generate new keypairs or upload new public keys at the bottom of:
[https://console.adobe.com](console.adobe.io) > Your Asset Compute Firefly project > Workspaces @ Development > Service Account (JWT).

Remember the `private.key` file should not be checked into Git as it contains secrets, rather it should be stored in a safe place outside the project.

For example, on macOS this might look like:

```
...
ASSET_COMPUTE_PRIVATE_KEY_FILE_PATH=/Users/example-user/credentials/aem-guides-wknd-asset-compute/private.key
...
```

## Configure Cloud Storage credentials

The credentials used by the Asset Compute application to interact with your Cloud Storage provider are provided in the `.env` file. Provide either the Azure Blob Storage credentials. The values can be obtained from either the Azure Portal or Amazon S3 console.

In this tutorial we will use Azure Blob Storage as our cloud storage provide, however Amazon S3 can be used instead.

### Using Azure Blob Storage cloud storage

If you are using [Microsoft Azure Blov Storage] uncomment and populate the following keys in the `.env` file. 
If you are NOT using Microsoft Azure Blov Storage, leave these commented out (by prefixing with `#`).

For example, this might look like (values for illustration only):

```
...
AZURE_STORAGE_ACCOUNT=aemguideswkndassetcomput
AZURE_STORAGE_KEY=Ba9CnisgabdsNJEJBqCYyNbYppbGbZ2VbhcUIcQEw+xxRUDxOUNY/eExll0vwoLsPt/OvbM+B7pkUdpEe7zJhg==
AZURE_STORAGE_CONTAINER_NAME=asset-compute
...
```

### Using Amazon S3 cloud storage

If you are using [Amazon S3 cloud storage] uncomment and populate the following keys in the `.env` file. 
If you are NOT using Amazon S3, leave these commented out (by prefixing with `#`).

For example, this might look like (values for illustration only):

```
...
S3_BUCKET=
AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=
AWS_REGION=
...
```

## Validating the project configuration

Once the generated Asset Compute project has been configured, validate the configuration prior to making code changes to ensure the supporting services are provisioned, in the `.env` files.

Open a shell terminal in the project root, and start up the Asset Conmpute Dev Tool to by executing the command:

```
$ aio app run
```

This starts the local Asset Compute Local Dev Tool at http://localhost:9000 which opens in a new Web browser.

Watch the terminal output as the Asset Compute Dev Tool intializes and the Web browser window for error messages.

To stop the Asset Compute Local Dev Tool, tap `Ctrl-C` in the terminal window that executed `aio app run` to terminate the process.


## Troubleshooting

### Asset Compute Local Dev tools cannot start due to missing private.key

+ __Error message:__ Local Dev ServerError: Missing required files at validatePrivateKeyFile.... (via standard out from `aio app run` command)
+ __Cause:__ The `ASSET_COMPUTE_PRIVATE_KEY_FILE_PATH` value in `.env` file, does not point to `private.key` or `private.key` is not read-able by the current user.
+ __Resolution:__ Review the `ASSET_COMPUTE_PRIVATE_KEY_FILE_PATH` value in `.env` file, and ensure it contains the full, absolute path to the `private.key` on your file system.
